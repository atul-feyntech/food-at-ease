---
interface Props {
  placeholder?: string;
  size?: 'small' | 'large';
}

const { placeholder = 'Maggi, Kurkure, Bournvita...', size = 'large' } = Astro.props;

const sizeClasses = size === 'large'
  ? 'py-4 text-lg'
  : 'py-2 text-base';
---

<div class="search-container relative w-full">
  <div id="search" class={sizeClasses}></div>
</div>

<script>
  import { PagefindUI } from '@pagefind/default-ui';

  // Initialize Pagefind when DOM is ready
  document.addEventListener('DOMContentLoaded', () => {
    new PagefindUI({
      element: '#search',
      showSubResults: true,
      showImages: false,
      translations: {
        placeholder: 'Search products... (Maggi, Kurkure, etc.)',
        zero_results: 'Kuch nahi mila "[SEARCH_TERM]" ke liye',
      },
    });
  });
</script>

<style is:global>
  /* Pagefind UI Customization for Mizan */
  .pagefind-ui {
    --pagefind-ui-scale: 1;
    --pagefind-ui-primary: #0D5C63;
    --pagefind-ui-text: #1f2937;
    --pagefind-ui-background: #ffffff;
    --pagefind-ui-border: #e5e7eb;
    --pagefind-ui-tag: #0D5C63;
    --pagefind-ui-border-width: 2px;
    --pagefind-ui-border-radius: 12px;
    --pagefind-ui-font: inherit;
  }

  .pagefind-ui__search-input {
    font-size: 1.125rem !important;
    padding: 1rem 1.25rem !important;
    border-radius: 12px !important;
    border: 2px solid #e5e7eb !important;
    transition: border-color 0.2s, box-shadow 0.2s !important;
  }

  .pagefind-ui__search-input:focus {
    outline: none !important;
    border-color: #0D5C63 !important;
    box-shadow: 0 0 0 3px rgba(13, 92, 99, 0.1) !important;
  }

  .pagefind-ui__search-clear {
    top: calc(50% - 10px) !important;
    right: 1rem !important;
  }

  .pagefind-ui__result {
    padding: 1rem !important;
    border-radius: 8px !important;
    margin-bottom: 0.5rem !important;
    background: #f9fafb !important;
    border: 1px solid #e5e7eb !important;
  }

  .pagefind-ui__result:hover {
    background: #f3f4f6 !important;
    border-color: #0D5C63 !important;
  }

  .pagefind-ui__result-link {
    color: #0D5C63 !important;
    font-weight: 600 !important;
    text-decoration: none !important;
  }

  .pagefind-ui__result-link:hover {
    text-decoration: underline !important;
  }

  .pagefind-ui__result-excerpt {
    color: #6b7280 !important;
    font-size: 0.875rem !important;
    margin-top: 0.25rem !important;
  }

  .pagefind-ui__message {
    color: #6b7280 !important;
    font-size: 0.875rem !important;
    padding: 1rem !important;
  }

  .pagefind-ui__results-area {
    margin-top: 1rem !important;
  }

  .pagefind-ui__button {
    background: #0D5C63 !important;
    color: white !important;
    border-radius: 8px !important;
    padding: 0.5rem 1rem !important;
  }

  .pagefind-ui__button:hover {
    background: #094449 !important;
  }

  /* Hide Pagefind branding */
  .pagefind-ui__suppressed {
    display: none !important;
  }
</style>
